<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie-edge">
    <link rel="stylesheet" href="../static/w3.css">
    <title>Skills `24</title>
</head>
<body>
    <div class="w3-bar w3-blue w3-padding w3-container">
        <h3>SKILLS 2024</h3>
    </div>

    <!-- MENU SECTION -->
    <div class="w3-container w3-padding w3-center">
        <h4>Select a Module</h4>
        <button class="w3-button w3-blue w3-margin" onclick="showModule('book')">Books</button>
        <button class="w3-button w3-green w3-margin" onclick="showModule('vets')">Veterinarians</button>
        <button class="w3-button w3-teal w3-margin" onclick="showModule('owners')">Pet Owners</button>
        <button class="w3-button w3-orange w3-margin" onclick="showModule('pets')">Pets</button>
        <button class="w3-button w3-red w3-margin" onclick="showModule('consultations')">Consultations</button>
    </div>

    <!-- BOOK MODULE (YOUR EXISTING FORM) -->
    <div id="bookModule" style="display: none;">
        <div class="w3-row-padding w3-margin">
            <div class="w3-half">
                <div class="w3-container w3-padding w3-round-xlarge w3-card-4">
                    <form id="bookForm" method="POST">
                        <p><label>ISBN</label><input type="text" name="isbn" class="w3-input" id="isbnInput"></p>
                        <p><label>TITLE</label><input type="text" name="title" class="w3-input" id="titleInput"></p>
                        <p><label>AUTHOR</label><input type="text" name="author" class="w3-input" id="authorInput"></p>
                        <p><label>COPYRIGHT</label><input type="text" name="copyright" class="w3-input" id="copyrightInput"></p>
                        <p><label>EDITION</label><input type="text" name="edition" class="w3-input" id="editionInput"></p>
                        <p><label>PRICE</label><input type="text" name="price" class="w3-input" id="priceInput"></p>
                        <p><label>QTY</label><input type="text" name="qty" class="w3-input" id="qtyInput"></p>
                    </form>
                </div>
            </div>

            <div class="w3-half w3-margin-bottom">
                <table class="w3-table">
                    <tr>
                        <td><button onclick="setFormAction('add')" class="w3-button w3-blue w3-input">ADD</button></td>
                        <td><button onclick="setFormAction('find')" class="w3-button w3-blue w3-input">FIND</button></td>
                    </tr>
                    <tr>
                        <td><button onclick="setFormAction('delete')" class="w3-button w3-blue w3-input" id="deleteBtn" disabled>DELETE</button></td>
                        <td><button onclick="setFormAction('update')" class="w3-button w3-blue w3-input" id="updateBtn" disabled>UPDATE</button></td>
                    </tr>
                </table>

                {% with messages = get_flashed_messages() %}
                    {% if messages %}
                        {% for message in messages %}
                        <div class="w3-panel w3-amber w3-padding w3-center" id="flashMessage">
                            {{ message }}
                        </div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}
            </div>

            <div class="w3-container w3-padding w3-margin-top">
                <table class="w3-table-all w3-bordered w3-striped w3-hoverable">
                    <thead>
                        <tr class="w3-blue">
                            <th>ISBN</th>
                            <th>TITLE</th>
                            <th>AUTHOR</th>
                            <th>COPYRIGHT</th>
                            <th>EDITION</th>
                            <th>PRICE</th>
                            <th>QTY</th>
                            <th>TOTAL</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for book in books %}
                            <tr>
                                <td>{{ book[0] }}</td>
                                <td>{{ book[1] }}</td>
                                <td>{{ book[2] }}</td>
                                <td>{{ book[3] }}</td>
                                <td>{{ book[4] }}</td>
                                <td>{{ book[5] }}</td>
                                <td>{{ book[6] }}</td>
                                <td>{{ "%.02f"|format(book[7]) }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- VET MODULE -->
    <div id="vetsModule" class="w3-container" style="display: none;">
        <div class="w3-row-padding w3-margin">
            <div class="w3-half">
                <div class="w3-container w3-padding w3-round-xlarge w3-card-4">
                    <form id="vetForm" method="POST">
                        <p><label>VET ID</label><input type="text" name="vet_id" class="w3-input" id="vetIdInput"></p>
                        <p><label>NAME</label><input type="text" name="name" class="w3-input" id="vetNameInput"></p>
                        <p><label>SPECIALIZATION</label><input type="text" name="specialization" class="w3-input" id="vetSpecializationInput"></p>
                        <p><label>CONTACT</label><input type="text" name="contact" class="w3-input" id="vetContactInput"></p>
                    </form>
                </div>
            </div>

            <div class="w3-half w3-margin-bottom">
                <table class="w3-table">
                    <tr>
                        <td><button onclick="setVetFormAction('add')" class="w3-button w3-green w3-input">ADD</button></td>
                        <td><button onclick="setVetFormAction('find')" class="w3-button w3-green w3-input">FIND</button></td>
                    </tr>
                    <tr>
                        <td><button onclick="setVetFormAction('delete')" class="w3-button w3-green w3-input" id="vetDeleteBtn" disabled>DELETE</button></td>
                        <td><button onclick="setVetFormAction('update')" class="w3-button w3-green w3-input" id="vetUpdateBtn" disabled>UPDATE</button></td>
                    </tr>
                </table>

                {% with messages = get_flashed_messages() %}
                    {% if messages %}
                        {% for message in messages %}
                        <div class="w3-panel w3-amber w3-padding w3-center" id="flashMessage">
                            {{ message }}
                        </div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}
            </div>

            <div class="w3-container w3-padding w3-margin-top">
                <table class="w3-table-all w3-bordered w3-striped w3-hoverable">
                    <thead>
                        <tr class="w3-green">
                            <th>VET ID</th>
                            <th>NAME</th>
                            <th>SPECIALIZATION</th>
                            <th>CONTACT</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for vet in vets %}
                            <tr>
                                <td>{{ vet[0] }}</td>
                                <td>{{ vet[1] }}</td>
                                <td>{{ vet[2] }}</td>
                                <td>{{ vet[3] }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- OWNER MODULE -->
    <div id="ownersModule" class="w3-container" style="display: none;">
        <div class="w3-row-padding w3-margin">
            <div class="w3-half">
                <div class="w3-container w3-padding w3-round-xlarge w3-card-4">
                    <form id="ownerForm" method="POST">
                        <p><label>OWNER ID</label><input type="text" name="owner_id" class="w3-input" id="ownerIdInput"></p>
                        <p><label>NAME</label><input type="text" name="name" class="w3-input" id="ownerNameInput"></p>
                        <p><label>ADDRESS</label><input type="text" name="address" class="w3-input" id="ownerAddressInput"></p>
                        <p><label>CONTACT</label><input type="text" name="contact" class="w3-input" id="ownerContactInput"></p>
                    </form>
                </div>
            </div>

            <div class="w3-half w3-margin-bottom">
                <table class="w3-table">
                    <tr>
                        <td><button onclick="setOwnerFormAction('add')" class="w3-button w3-teal w3-input">ADD</button></td>
                        <td><button onclick="setOwnerFormAction('find')" class="w3-button w3-teal w3-input">FIND</button></td>
                    </tr>
                    <tr>
                        <td><button onclick="setOwnerFormAction('delete')" class="w3-button w3-teal w3-input" id="ownerDeleteBtn" disabled>DELETE</button></td>
                        <td><button onclick="setOwnerFormAction('update')" class="w3-button w3-teal w3-input" id="ownerUpdateBtn" disabled>UPDATE</button></td>
                    </tr>
                </table>

                {% with messages = get_flashed_messages() %}
                    {% if messages %}
                        {% for message in messages %}
                        <div class="w3-panel w3-amber w3-padding w3-center" id="flashMessage">
                            {{ message }}
                        </div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}
            </div>

            <div class="w3-container w3-padding w3-margin-top">
                <table class="w3-table-all w3-bordered w3-striped w3-hoverable">
                    <thead>
                        <tr class="w3-teal">
                            <th>OWNER ID</th>
                            <th>NAME</th>
                            <th>ADDRESS</th>
                            <th>CONTACT</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for owner in owners %}
                            <tr>
                                <td>{{ owner[0] }}</td>
                                <td>{{ owner[1] }}</td>
                                <td>{{ owner[2] }}</td>
                                <td>{{ owner[3] }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- PET MODULE -->
    <div id="petsModule" class="w3-container" style="display: none;">
        <div class="w3-row-padding w3-margin">
            <div class="w3-half">
                <div class="w3-container w3-padding w3-round-xlarge w3-card-4">
                    <form id="petForm" method="POST">
                        <p><label>PET ID</label><input type="text" name="pet_id" class="w3-input" id="petIdInput"></p>
                        <p><label>NAME</label><input type="text" name="name" class="w3-input" id="petNameInput"></p>
                        <p><label>SPECIES</label><input type="text" name="species" class="w3-input" id="petSpeciesInput"></p>
                        <p><label>BREED</label><input type="text" name="breed" class="w3-input" id="petBreedInput"></p>
                        <p><label>OWNER ID</label><input type="text" name="owner_id" class="w3-input" id="petOwnerIdInput"></p>
                    </form>
                </div>
            </div>

            <div class="w3-half w3-margin-bottom">
                <table class="w3-table">
                    <tr>
                        <td><button onclick="setPetFormAction('add')" class="w3-button w3-orange w3-input">ADD</button></td>
                        <td><button onclick="setPetFormAction('find')" class="w3-button w3-orange w3-input">FIND</button></td>
                    </tr>
                    <tr>
                        <td><button onclick="setPetFormAction('delete')" class="w3-button w3-orange w3-input" id="petDeleteBtn" disabled>DELETE</button></td>
                        <td><button onclick="setPetFormAction('update')" class="w3-button w3-orange w3-input" id="petUpdateBtn" disabled>UPDATE</button></td>
                    </tr>
                </table>

                {% with messages = get_flashed_messages() %}
                    {% if messages %}
                        {% for message in messages %}
                        <div class="w3-panel w3-amber w3-padding w3-center" id="flashMessage">
                            {{ message }}
                        </div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}
            </div>

             <div class="w3-container w3-padding w3-margin-top">
                <table class="w3-table-all w3-bordered w3-striped w3-hoverable">
                    <thead>
                        <tr class="w3-orange">
                            <th>PET ID</th>
                            <th>NAME</th>
                            <th>SPECIES</th>
                            <th>BREED</th>
                            <th>OWNER ID</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for pet in pets %}
                            <tr>
                                <td>{{ pet[0] }}</td>
                                <td>{{ pet[1] }}</td>
                                <td>{{ pet[2] }}</td>
                                <td>{{ pet[3] }}</td>
                                <td>{{ pet[4] }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- CONSULTATION MODULE -->
    <div id="consultationsModule" class="w3-container" style="display: none;">
        <div class="w3-row-padding w3-margin">
            <div class="w3-half">
                <div class="w3-container w3-padding w3-round-xlarge w3-card-4">
                    <form id="consultationForm" method="POST">
                        <p><label>CONSULT ID</label><input type="text" name="consult_id" class="w3-input" id="consultationIdInput"></p>
                        <p><label>PET ID</label><input type="text" name="pet_id" class="w3-input" id="consultationPetIdInput"></p>
                        <p><label>VET ID</label><input type="text" name="vet_id" class="w3-input" id="consultationVetIdInput"></p>
                        <p><label>DATE</label><input type="text" name="date" class="w3-input" id="consultationDateInput"></p>
                        <p><label>DIAGNOSIS</label><input type="text" name="diagnosis" class="w3-input" id="consultationDiagnosisInput"></p>
                        <p><label>TREATMENT</label><input type="text" name="treatment" class="w3-input" id="consultationTreatmentInput"></p>
                    </form>
                </div>
            </div>

            <div class="w3-half w3-margin-bottom">
                <table class="w3-table">
                    <tr>
                        <td><button onclick="setConsultationFormAction('add')" class="w3-button w3-red w3-input">ADD</button></td>
                        <td><button onclick="setConsultationFormAction('find')" class="w3-button w3-red w3-input">FIND</button></td>
                    </tr>
                    <tr>
                        <td><button onclick="setConsultationFormAction('delete')" class="w3-button w3-red w3-input" id="consultationDeleteBtn" disabled>DELETE</button></td>
                        <td><button onclick="setConsultationFormAction('update')" class="w3-button w3-red w3-input" id="consultationUpdateBtn" disabled>UPDATE</button></td>
                    </tr>
                </table>

                {% with messages = get_flashed_messages() %}
                    {% if messages %}
                        {% for message in messages %}
                        <div class="w3-panel w3-amber w3-padding w3-center" id="flashMessage">
                            {{ message }}
                        </div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}
            </div>

            <div class="w3-container w3-padding w3-margin-top">
                <table class="w3-table-all w3-bordered w3-striped w3-hoverable">
                    <thead>
                        <tr class="w3-red">
                            <th>CONSULT ID</th>
                            <th>PET ID</th>
                            <th>VET ID</th>
                            <th>DATE</th>
                            <th>DIAGNOSIS</th>
                            <th>TREATMENT</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for consultation in consultations %}
                            <tr>
                                <td>{{ consultation[0] }}</td>
                                <td>{{ consultation[1] }}</td>
                                <td>{{ consultation[2] }}</td>
                                <td>{{ consultation[3] }}</td>
                                <td>{{ consultation[4] }}</td>
                                <td>{{ consultation[5] }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</body>

<!-- JS SECTION -->
<script>
    let foundIsbn = null;
    let foundVetId = null;
    let foundOwnerId = null;
    let foundPetId = null;
    let foundConsultationId = null;
    let currentModule = 'book';

    function showModule(moduleName) {
        const allModules = ['bookModule', 'vetsModule', 'ownersModule', 'petsModule', 'consultationsModule'];
        allModules.forEach(id => {
            const el = document.getElementById(id);
            if (el) el.style.display = 'none';
        });

        const moduleId = moduleName + 'Module';
        const moduleDiv = document.getElementById(moduleId);
        if (moduleDiv) {
            moduleDiv.style.display = 'block';
            currentModule = moduleName;
        }
    }

    // Book form actions
    function setFormAction(action) {
        const form = document.getElementById('bookForm');

        if (action === 'find') {
            const isbnInput = document.getElementById('isbnInput');
            if (!isbnInput.value) {
                alert('Please enter an ISBN to find!');
                return;
            }
            form.action = '/findbook';
            form.submit();
            return;
        }

        if ((action === 'update' || action === 'delete') && !foundIsbn) {
            alert('Please find a book first!');
            return;
        }

        if (action === 'update' || action === 'delete') {
            document.getElementById('isbnInput').value = foundIsbn;
        }

        switch (action) {
            case 'add':
                form.action = '/addbook';
                break;
            case 'delete':
                form.action = '/deletebook';
                break;
            case 'update':
                form.action = '/updatebook';
                break;
        }
        form.submit();
    }

    // Vet form actions
    function setVetFormAction(action) {
        const form = document.getElementById('vetForm');

        if (action === 'find') {
            const vetIdInput = document.getElementById('vetIdInput');
            if (!vetIdInput.value) {
                alert('Please enter a Vet ID to find!');
                return;
            }
            form.action = '/findvet';
            form.submit();
            return;
        }

        if ((action === 'update' || action === 'delete') && !foundVetId) {
            alert('Please find a vet first!');
            return;
        }

        if (action === 'update' || action === 'delete') {
            document.getElementById('vetIdInput').value = foundVetId;
        }

        switch (action) {
            case 'add':
                form.action = '/addvet';
                break;
            case 'delete':
                form.action = '/deletevet';
                break;
            case 'update':
                form.action = '/updatevet';
                break;
        }
        form.submit();
    }

    // Owner form actions
    function setOwnerFormAction(action) {
        const form = document.getElementById('ownerForm');

        if (action === 'find') {
            const ownerIdInput = document.getElementById('ownerIdInput');
            if (!ownerIdInput.value) {
                alert('Please enter an Owner ID to find!');
                return;
            }
            form.action = '/findowner';
            form.submit();
            return;
        }

        if ((action === 'update' || action === 'delete') && !foundOwnerId) {
            alert('Please find an owner first!');
            return;
        }

        if (action === 'update' || action === 'delete') {
            document.getElementById('ownerIdInput').value = foundOwnerId;
        }

        switch (action) {
            case 'add':
                form.action = '/addowner';
                break;
            case 'delete':
                form.action = '/deleteowner';
                break;
            case 'update':
                form.action = '/updateowner';
                break;
        }
        form.submit();
    }

    // Pet form actions
    function setPetFormAction(action) {
        const form = document.getElementById('petForm');

        if (action === 'find') {
            const petIdInput = document.getElementById('petIdInput');
            if (!petIdInput.value) {
                alert('Please enter a Pet ID to find!');
                return;
            }
            form.action = '/findpet';
            form.submit();
            return;
        }

        if ((action === 'update' || action === 'delete') && !foundPetId) {
            alert('Please find a pet first!');
            return;
        }

        if (action === 'update' || action === 'delete') {
            document.getElementById('petIdInput').value = foundPetId;
        }

        switch (action) {
            case 'add':
                form.action = '/addpet';
                break;
            case 'delete':
                form.action = '/deletepet';
                break;
            case 'update':
                form.action = '/updatepet';
                break;
        }
        form.submit();
    }

    // Consultation form actions
    function setConsultationFormAction(action) {
        const form = document.getElementById('consultationForm');

        if (action === 'find') {
            const consultationIdInput = document.getElementById('consultationIdInput');
            if (!consultationIdInput.value) {
                alert('Please enter a Consultation ID to find!');
                return;
            }
            form.action = '/findconsultation';
            form.submit();
            return;
        }

        if ((action === 'update' || action === 'delete') && !foundConsultationId) {
            alert('Please find a consultation first!');
            return;
        }

        if (action === 'update' || action === 'delete') {
            document.getElementById('consultationIdInput').value = foundConsultationId;
        }

        switch (action) {
            case 'add':
                form.action = '/addconsultation';
                break;
            case 'delete':
                form.action = '/deleteconsultation';
                break;
            case 'update':
                form.action = '/updateconsultation';
                break;
        }
        form.submit();
    }

    window.onload = function () {
        const flashMessageDiv = document.getElementById('flashMessage');
        if (flashMessageDiv) {
            const message = flashMessageDiv.textContent.trim();

            // Book message handling
            if (message.startsWith('Book found:')) {
                document.getElementById('deleteBtn').disabled = false;
                document.getElementById('updateBtn').disabled = false;

                try {
                    const details = message.replace('Book found: ', '').split(', ');
                    const bookData = {};
                    details.forEach(item => {
                        const [key, value] = item.split(': ');
                        bookData[key.toLowerCase()] = value;
                    });

                    document.getElementById('isbnInput').value = bookData.isbn || '';
                    document.getElementById('titleInput').value = bookData.title || '';
                    document.getElementById('authorInput').value = bookData.author || '';
                    document.getElementById('copyrightInput').value = bookData.copyright || '';
                    document.getElementById('editionInput').value = bookData.edition || '';
                    document.getElementById('priceInput').value = bookData.price || '';
                    document.getElementById('qtyInput').value = bookData.quantity || '';
                    foundIsbn = bookData.isbn || null;

                } catch (error) {
                    console.error('Error parsing book details:', error);
                    document.getElementById('deleteBtn').disabled = true;
                    document.getElementById('updateBtn').disabled = true;
                    foundIsbn = null;
                }
            }
            // Vet message handling
            else if (message.startsWith('Vet found:')) {
                document.getElementById('vetDeleteBtn').disabled = false;
                document.getElementById('vetUpdateBtn').disabled = false;

                try {
                    const details = message.replace('Vet found: ', '').split(', ');
                    const vetData = {};
                    details.forEach(item => {
                        const [key, value] = item.split(': ');
                        vetData[key.toLowerCase()] = value;
                    });

                    document.getElementById('vetIdInput').value = vetData.id || '';
                    document.getElementById('vetNameInput').value = vetData.name || '';
                    document.getElementById('vetSpecializationInput').value = vetData.specialization || '';
                    document.getElementById('vetContactInput').value = vetData.contact || '';
                    foundVetId = vetData.id || null;

                } catch (error) {
                    console.error('Error parsing vet details:', error);
                    document.getElementById('vetDeleteBtn').disabled = true;
                    document.getElementById('vetUpdateBtn').disabled = true;
                    foundVetId = null;
                }
            }
            // Owner message handling
            else if (message.startsWith('Owner found:')) {
                document.getElementById('ownerDeleteBtn').disabled = false;
                document.getElementById('ownerUpdateBtn').disabled = false;

                try {
                    const details = message.replace('Owner found: ', '').split(', ');
                    const ownerData = {};
                    details.forEach(item => {
                        const [key, value] = item.split(': ');
                        ownerData[key.toLowerCase()] = value;
                    });

                    document.getElementById('ownerIdInput').value = ownerData.id || '';
                    document.getElementById('ownerNameInput').value = ownerData.name || '';
                    document.getElementById('ownerAddressInput').value = ownerData.address || '';
                    document.getElementById('ownerContactInput').value = ownerData.contact || '';
                    foundOwnerId = ownerData.id || null;

                } catch (error) {
                    console.error('Error parsing owner details:', error);
                    document.getElementById('ownerDeleteBtn').disabled = true;
                    document.getElementById('ownerUpdateBtn').disabled = true;
                    foundOwnerId = null;
                }
            }
            // Pet message handling
            else if (message.startsWith('Pet found:')) {
                document.getElementById('petDeleteBtn').disabled = false;
                document.getElementById('petUpdateBtn').disabled = false;

                try {
                    const details = message.replace('Pet found: ', '').split(', ');
                    const petData = {};
                    details.forEach(item => {
                        const [key, value] = item.split(': ');
                        petData[key.toLowerCase()] = value;
                    });

                    document.getElementById('petIdInput').value = petData.id || '';
                    document.getElementById('petNameInput').value = petData.name || '';
                    document.getElementById('petSpeciesInput').value = petData.species || '';
                    document.getElementById('petBreedInput').value = petData.breed || '';
                    document.getElementById('petOwnerIdInput').value = petData.owner_id || '';
                    foundPetId = petData.id || null;

                } catch (error) {
                    console.error('Error parsing pet details:', error);
                    document.getElementById('petDeleteBtn').disabled = true;
                    document.getElementById('petUpdateBtn').disabled = true;
                    foundPetId = null;
                }
            }
            // Consultation message handling
            else if (message.startsWith('Consultation found:')) {
                document.getElementById('consultationDeleteBtn').disabled = false;
                document.getElementById('consultationUpdateBtn').disabled = false;

                try {
                    const details = message.replace('Consultation found: ', '').split(', ');
                    const consultationData = {};
                    details.forEach(item => {
                        const [key, value] = item.split(': ');
                        consultationData[key.toLowerCase()] = value;
                    });

                    document.getElementById('consultationIdInput').value = consultationData.id || '';
                    document.getElementById('consultationPetIdInput').value = consultationData.pet_id || '';
                    document.getElementById('consultationVetIdInput').value = consultationData.vet_id || '';
                    document.getElementById('consultationDateInput').value = consultationData.date || '';
                    document.getElementById('consultationDiagnosisInput').value = consultationData.diagnosis || '';
                    document.getElementById('consultationTreatmentInput').value = consultationData.treatment || '';
                    foundConsultationId = consultationData.id || null;

                } catch (error) {
                    console.error('Error parsing consultation details:', error);
                    document.getElementById('consultationDeleteBtn').disabled = true;
                    document.getElementById('consultationUpdateBtn').disabled = true;
                    foundConsultationId = null;
                }
            }

            
            // Success message handling
            if (message.includes('Successfully') || message.includes('deleted successfully!') || message.includes('Added')) {
                // Reset all forms and buttons
                document.getElementById('bookForm').reset();
                document.getElementById('vetForm').reset();
                document.getElementById('ownerForm').reset();
                document.getElementById('petForm').reset();
                document.getElementById('consultationForm').reset();

                document.getElementById('deleteBtn').disabled = true;
                document.getElementById('updateBtn').disabled = true;
                document.getElementById('vetDeleteBtn').disabled = true;
                document.getElementById('vetUpdateBtn').disabled = true;
                document.getElementById('ownerDeleteBtn').disabled = true;
                document.getElementById('ownerUpdateBtn').disabled = true;
                document.getElementById('petDeleteBtn').disabled = true;
                document.getElementById('petUpdateBtn').disabled = true;
                document.getElementById('consultationDeleteBtn').disabled = true;
                document.getElementById('consultationUpdateBtn').disabled = true;

                foundIsbn = null;
                foundVetId = null;
                foundOwnerId = null;
                foundPetId = null;
                foundConsultationId = null;
            }
        }

        // Check URL parameters for module
        const urlParams = new URLSearchParams(window.location.search);
        const moduleParam = urlParams.get('module');
        if (moduleParam) {
            showModule(moduleParam);
        } else {
            showModule('book');
        }
    }
</script>
</html>
